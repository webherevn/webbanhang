<% 
    /**
     * LOGIC KIỂM TRA DỮ LIỆU AN TOÀN
     */
    let displayProducts = [];
    if (typeof section !== 'undefined' && section.products) {
        displayProducts = section.products;
    } else if (typeof products !== 'undefined') {
        displayProducts = products;
    }
%>
<section class="py-5" id="grid-<%= section._id %>">
    <div class="container">
        <div class="d-flex justify-content-between align-items-end mb-5">
            <div class="section-title">
                <h2 class="fw-bold text-uppercase m-0"><%= data.title %></h2>
                <div class="bg-dark mt-2" style="width: 40px; height: 2px;"></div>
            </div>
            <a href="<%= data.buttonLink %>" class="text-dark fw-bold text-decoration-none small border-bottom border-2 border-dark">
                XEM TẤT CẢ <i class="bi bi-chevron-right"></i>
            </a>
        </div>

        <div class="row g-3 g-md-4">
            <% (section.products || []).forEach(product => { %>
                <div class="col-6 col-md-4 col-lg-3">
                    <div class="pro-card">
                        <div class="img-wrapper">
                            <% if(product.discount > 0) { %>
                                <span class="badge bg-danger position-absolute top-0 start-0 m-2 z-2">-<%= product.discount %>%</span>
                            <% } %>
                            <a href="/products/<%= product.slug %>">
                                <img src="<%= product.thumbnail %>" alt="<%= product.name %>">
                            </a>
                            <div class="quick-add position-absolute bottom-0 w-100 p-2 opacity-0 translate-y-100 transition-all">
                                <button class="btn btn-dark w-100 btn-sm rounded-0 py-2 fw-bold">THÊM VÀO GIỎ</button>
                            </div>
                        </div>
                        <div class="py-3 text-center">
                            <p class="text-muted small mb-1 text-uppercase"><%= product.category ? product.category.name : '' %></p>
                            <h6 class="fw-bold mb-2">
                                <a href="/products/<%= product.slug %>" class="text-decoration-none text-dark"><%= product.name %></a>
                            </h6>
                            <div class="price">
                                <span class="text-danger fw-bold"><%= product.basePrice.toLocaleString('vi-VN') %>đ</span>
                            </div>
                        </div>
                    </div>
                </div>
            <% }) %>
        </div>
    </div>
</section>

